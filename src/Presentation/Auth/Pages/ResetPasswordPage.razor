@page "/auth/resetpasswordpage/{Token}"

@attribute [AllowAnonymous]

@inject IStringLocalizer<ResetPasswordPage> _localizer;

@inherits BaseAuthPage;

<PageLoading>
    <LoadedContent>
        <MudCard Class="container d-flex container-fit-content p-5" Style="border-radius: 1rem;">
            <MudForm @ref="@Form"
                     Model="@Model"
                     Validation="@(Validator.ValidateValue)"
                     ValidationDelay="0">
                <MudGrid>

                    <MudItem xs="12">
                        <PasswordTextField @bind-Value="Model.Password"
                                           For="@(() => Model.Password)"
                                           Label="@_localizer["Password"]"
                                           HelperText="@_localizer["Provide password for your account."]" />
                    </MudItem>
                    <MudItem xs="12">
                        <MudTextField @bind-Value="Model.ConfirmPassword"
                                      T="string"
                                      For="@(() => Model.ConfirmPassword)"
                                      Variant="Variant.Filled"
                                      Clearable="true"
                                      InputType="InputType.Password"
                                      Label="@_localizer["Confirm Password"]"
                                      HelperText="@_localizer["Please repeat password."]" />
                    </MudItem>

                    <MudItem xs="7">

                    </MudItem>
                    <MudItem xs="5" Class="d-flex justify-end">
                        <MudButton Variant="Variant.Filled"
                                   OnClick="ResetPasswordAsync"
                                   Color="Color.Primary"
                                   Size="Size.Large"
                                   EndIcon="@Icons.Material.Filled.Login"
                                   Style="width: 100%;">
                            @_localizer["Sign In"]
                        </MudButton>

                    </MudItem>
                </MudGrid>
            </MudForm>
        </MudCard>
    </LoadedContent>
</PageLoading>

@code
{
    [Parameter]
    public string Token { get; set; } = string.Empty;

    public ResetPasswordValidator Validator { get; set; } = new();
    public ResetPasswordModel Model { get; set; } = new();

    private async Task ResetPasswordAsync()
    {
        //TODO: for all no authentication pages - providae not authenticaed state to properly load UI / or stop reload page
    }
}
